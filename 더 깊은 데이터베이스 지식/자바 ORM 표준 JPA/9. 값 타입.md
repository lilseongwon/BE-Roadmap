# ê¸°ë³¸ê°’ íƒ€ì…

```java
@Entity
public class Member {

	@Id @GeneratedValue
	private Long id;
	
	private String name;
	private int age;
	
	//ê·¼ë¬´ ê¸°ê°„
	@Temporal(TemporalType.DATE) 
	Date startDate;
	@Temporal(TemporalType.DATE)
	Date endDate;

	//ì§‘ ì£¼ì†Œ í‘œí˜„
	private String city;
	private String street;
	private String zipcode;
}
```

`String`, `int`ê°€ ê°’ íƒ€ì…ì´ë‹¤. ì—”í‹°í‹°ëŠ” ì‹ë³„ì(id)ì™€ ìƒëª…ì£¼ê¸°ê°€ ìˆì§€ë§Œ ê°’ íƒ€ì…ì€ ì‹ë³„ì ê°’ë„ ì—†ê³  ìƒëª…ì£¼ê¸°ë„ íšŒì› ì—”í‹°í‹°ì— ì˜ì¡´í•œë‹¤. ê·¸ë¦¬ê³  ê°’ íƒ€ì…ì€ ê³µìœ í•˜ë©´ ì•ˆëœë‹¤(ë‹¤ë¥¸ íšŒì› ì´ë¦„ì„ ë°”ê¿¨ë‹¤ê³  ë‚´ ì´ë¦„ë„ ë°”ë€Œë©´ ì•ˆë¨)

# ì„ë² ë””ë“œ íƒ€ì…

ìƒˆë¡œìš´ ê°’ íƒ€ì…ì„ ì§ì ‘ ì •ì˜í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. JPAì—ì„œëŠ” ì´ë¥¼ ì„ë² ë””ë“œ íƒ€ì…ì´ë¼ í•˜ëŠ”ë°, ì˜ˆë¥¼ ë“¤ì–´ íšŒì›ì´ ìƒì„¸í•œ ë°ì´í„°(ê¸°ê°„, ì£¼ì†Œ ë“±)ë¥¼ ê°€ì§€ëŠ” ê²ƒì€ ê°ì²´ì§€í–¥ì ì´ì§€ ì•Šê³  ì‘ì§‘ë ¥ë§Œ ë–¨ì–´ëœ¨ë¦°ë‹¤. ì£¼ì†Œ íƒ€ì…ì´ ìˆë‹¤ë©´ ì½”ë“œê°€ ë” ëª…í™•í•´ì§ˆ ê²ƒì´ë‹¤.

```java
@Entity
public class Member {
	...
	@Embedded Period wordPeriod; //ê·¼ë¬´ ê¸°ê°„
	@Embedded Address homeAddress //ì§‘ ì£¼ì†Œ

```

```java
@Embeddable
public class Period {
	
	@Temporal(TemporalType.DATE) 
	Date startDate;
	@Temporal(TemporalType.DATE)
	Date endDate;
	//..

	public boolean isWork(Date date) {
			//.. ê°’ íƒ€ì…ì„ ìœ„í•œ ë©”ì†Œë“œë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
	}
}
```

```java
@Embeddable
public class Address {

	@Column (name="city") //ë§¤í•‘í•  ì»¬ëŸ¼ ì •ì˜ ê°€ëŠ¥
	private String city;
	private String street;
	private String zipCode;
	//..
}
```

![image](https://user-images.githubusercontent.com/102791105/206199600-310433b3-433c-4cef-a577-6eaa22cf5fe9.png)

ìƒˆë¡œ ì •ì˜í•œ ê°’ íƒ€ì…ë“¤ì€ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì‘ì§‘ë„ë„ ì•„ì£¼ ë†’ë‹¤. ë˜í•œ ì˜ˆì œì˜ Period.isWork() ì²˜ëŸ¼ í•´ë‹¹ ê°’ íƒ€ì…ë§Œ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ ìˆëŠ” ë©”ì†Œë“œë„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒ 2ê°€ì§€ ì–´ë…¸í…Œì´ì…˜ì´ í•„ìš”í•˜ë‹¤. ë‘˜ ì¤‘ í•˜ë‚˜ëŠ” ìƒëµí•´ë„ ëœë‹¤.

- `@Embeddable` : ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ
- `@Embedded` : ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ

**ì„ë² ë””ë“œ íƒ€ì…ì€ ê¸°ë³¸ ìƒì„±ìê°€ í•„ìˆ˜ë‹¤.** 

ì„ë² ë””ë“œ íƒ€ì…ì„ í¬í•¨í•œ ëª¨ë“  ê°’ íƒ€ì…ì€ ì—”í‹°í‹°ì˜ ìƒëª…ì£¼ê¸°ì— ì˜ì¡´í•˜ë¯€ë¡œ ì—”í‹°í‹°ì™€ ì„ë² ë””ë“œ íƒ€ì…ì˜ ê´€ê³„ë¥¼ UMLë¡œ í‘œí˜„í•˜ë©´ **ì»´í¬ì§€ì…˜ ê´€ê³„**(ìˆ˜ëª…ì´ ì¢…ì†ë¨)ê°€ ëœë‹¤

### ì„ë² ë””ë“œ íƒ€ì…ê³¼ í…Œì´ë¸” ë§¤í•‘
![image](https://user-images.githubusercontent.com/102791105/206204080-e181e77b-ac10-4c45-a02a-1f6269d4b506.png)

ì„ë² ë””ë“œ íƒ€ì… ë•ë¶„ì— ê°ì²´ì™€ í…Œì´ë¸”ì„ ì•„ì£¼ ì„¸ë°€í•˜ê²Œ ë§¤í•‘í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤. **ì˜ ì„¤ê³„í•œ ORM ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë§¤í•‘í•œ í…Œì´ë¸”ì˜ ìˆ˜ë³´ë‹¤ í´ë˜ìŠ¤ì˜ ìˆ˜ê°€ ë” ë§ë‹¤**

### ì„ë² ë””ë“œ íƒ€ì… ì—°ê´€ê´€ê³„

ì„ë² ë””ë“œ íƒ€ì…ì€ ê°’ íƒ€ì…ì„ í¬í•¨í•˜ê±°ë‚˜ ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤

![image](https://user-images.githubusercontent.com/102791105/206205165-ae1f4add-1a2d-46ba-8b95-af60d7a802c7.png)

```java
@Entity
public class Member {

	@Embedded Address address; //ì„ë² ë””ë“œ íƒ€ì… í¬í•¨
	@Embedded PhoneNumber phoneNumber; //ì„ë² ë””ë“œ íƒ€ì… í¬í•¨
	//...
}

@Embeddable
public class Address {
	String street;
	String city;
	String state;
	@Embedded Zipcode zipcode; //ì„ë² ë””ë“œ íƒ€ì… í¬í•¨
}

@Embeddable
public class Zipcode {
	String zip;
	String plusFour;
}

@Embeddable
public class PhoneNumber {
	String areaCode;
	String localNumber;
	@ManyToOne PhoneServiceProvider provider; //ì—”í‹°í‹° ì°¸ì¡°
	...
}

@Entity
public class PhoneServiceProvider {
	@Id String name;
	...
}
```

ê°’ íƒ€ì…ì¸ `Address`ê°€ ê°’ íƒ€ì…ì¸ `zipcode`ë¥¼ í¬í•¨í•˜ê³ , ê°’ íƒ€ì…ì¸ `PhoneNumber`ê°€ ì—”í‹°í‹° íƒ€ì…ì¸ `PhoneServiceProvider`ë¥¼ ì°¸ì¡°í•œë‹¤

## @AttributeOverride: ì†ì„± ì¬ì •ì˜

ì„ë² ë””ë“œ íƒ€ì…ì— ì •ì˜í•œ ë§¤í•‘ì •ë³´ë¥¼ ì¬ì •ì˜í•˜ë ¤ë©´ ì—”í‹°í‹°ì— `@AttributeOverride`ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

ì£¼ì†Œê°€ ì¤‘ë³µë  ë•Œë¥¼ ì˜ˆë¡œ ë“¤ì–´ë³´ì

```java
@Entity
public class Member {

	@Id @GeneratedValue
	private Long id;
	private String name;

	@Embedded Address homeAddress;

	@Embedded
	@AttributeOverrides({
			@AttributeOverride(name = "city", column=@Column(name = "COMPANY_CITY)),
			@AttributeOverride(name = "street", column=@Column(name = "COMPANY_STREET")),
			@AttributeOverride(name = "zipcode", column=@Column(name = "COMPANY_ZIPCODE"))
	})
	Address companyAddress;
}
```

# ê°’ íƒ€ì…ê³¼ ë¶ˆë³€ ê°ì²´

## ê°’ íƒ€ì… ê³µìœ  ì°¸ì¡°

![image](https://user-images.githubusercontent.com/102791105/206320012-969a1e12-6097-4f20-95b1-c8dc3225faf7.png)

**íšŒì›2ì˜ ì£¼ì†Œë§Œ â€˜NewCityâ€ë¡œ ë³€ê²½ë˜ê¸¸ ê¸°ëŒ€í–ˆì§€ë§Œ íšŒì›1ì˜ ì£¼ì†Œë„ â€œNewCityâ€ë¡œ ë³€ê²½ë˜ì–´ ë²„ë¦°ë‹¤**

íšŒì›1ê³¼ íšŒì›2ê°€ ê°™ì€ address ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•˜ê¸° ë•Œë¬¸ì— ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” íšŒì›1ê³¼ íšŒì›2 ê°ê° UPDATE SQLì„ ì‹¤í–‰í•œë‹¤(=ë¶€ì‘ìš©)

## ê°’ íƒ€ì… ë³µì‚¬

ë¶€ì‘ìš©ì„ ë§‰ê¸° ìœ„í•´ì„  ê°’ì„ ë³µì‚¬í•˜ë©´ ëœë‹¤

![image](https://user-images.githubusercontent.com/102791105/206320410-bf967c46-9f44-471c-9811-4f6b6b0d7673.png)

```java
Address address = member1.getHomeAddress();

Address newAddress = address.clone();

newAddress.setCity("newCity");
member2.setHomeAddress(newAddress);
```

ê°’ì„ ë³µí•˜í•˜ë©´ ê³µìœ  ì°¸ì¡°ì˜ ë¶€ì‘ìš©ì„ í”¼í•  ìˆ˜ ìˆì§€ë§Œ ì„ë² ë””ë“œ íƒ€ì…ë“±ì˜ ì§ì ‘ ì •ì˜í•œ ê°’ íƒ€ì…ì€ **ìë°”ì˜ ê¸°ë³¸íƒ€ì…ì´ ì•„ë‹ˆë¼ ê°ì²´ íƒ€ì…**ì´ë¼ëŠ” ê²ƒì´ë‹¤

**ë³µì‚¬í•˜ì§€ ì•Šê³  ì›ë³¸ì˜ ì°¸ì¡° ê°’ì„ ì§ì ‘ ë„˜ê¸°ëŠ” ê²ƒì„ ë§‰ì„ ë°©ë²•ì´ ì—†ë‹¤ëŠ” ê²ƒì´ë‹¤. ê°ì²´ì˜ ê³µìœ  ì°¸ì¡°ëŠ” í”¼í•  ìˆ˜ ì—†ë‹¤**

## ë¶ˆë³€ ê°ì²´

ê°ì²´ë¥¼ ë¶ˆë³€í•˜ê²Œ ë§Œë“¤ë©´ ê°’ì„ ìˆ˜ì •í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ë¶€ì‘ìš©ì„ ì›ì²œ ì°¨ë‹¨í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ê°’ íƒ€ì…ì€ ë  ìˆ˜ ìˆìœ¼ë©´ ë¶ˆë³€ ê°ì²´ë¡œ ì„¤ê³„í•´ì•¼ í•œë‹¤. ìƒì„±ìë¡œ ì´ˆê¸° ê°’ì„ ì„¤ì •í•˜ê³  Setterë¥¼ ë§Œë“¤ì§€ ì•Šìœ¼ë©´ ëœë‹¤.

**ë¶ˆë³€ì´ë¼ëŠ” ì‘ì€ ì œì•½ìœ¼ë¡œ ë¶€ì‘ìš©ì´ë¼ëŠ” í° ì¬ì•™ì„ ë§‰ì„ ìˆ˜ ìˆë‹¤**

# ê°’ íƒ€ì…ì˜ ë¹„êµ

ìë°”ê°€ ì œê³µí•˜ëŠ” ê°ì²´ ë¹„êµëŠ” 2ê°€ì§€ë‹¤

- ë™ì¼ì„± ë¹„êµ : ì¸ìŠ¤í„´ìŠ¤ ì°¸ì¡° ê°’ ë¹„êµ, `==`
- ë™ë“±ì„± ë¹„êµ : ì¸ìŠ¤í„´ìŠ¤ ê°’ ë¹„êµ, `equals()`

`Address` ê°’ íƒ€ì…ì„ `a == b`ë¡œ ë™ì¼ì„± ë¹„êµí•˜ë©´ ë‘˜ì€ ì„œë¡œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì´ë¯€ë¡œ ê²°ê³¼ëŠ” ê±°ì§“ì´ë‹¤. ë”°ë¼ì„œ ê°’ íƒ€ì…ì„ ë¹„êµí•  ë•ŒëŠ” `a.equals(b)`ë¥¼ ì‚¬ìš©í•´ì„œ ë™ë“±ì„± ë¹„êµë¥¼ í•´ì•¼ í•˜ë¯€ë¡œ `equals()`ë©”ì†Œë“œë¥¼ ëª¨ë“  í•„ë“œì˜ ê°’ì„ ë¹„êµí•˜ë„ë¡ ì¬ì •ì˜ í•´ì•¼ í•œë‹¤

# ê°’ íƒ€ì… ì»¬ë ‰ì…˜

```java
@Entity
public class Member {

	@Id @GeneratedValue
	private Long id;

	@Embedded
	private Address homeAddress;
	
	@ElementCollection
	@CollectionTable(name = "FAVOIRATE_FOODS",
			joinColumns = @JoinColumn(name = "MEMBER_ID"))
	@Column(name = "FOOD_NAME")
	private Set<String> favoriteFoods = new HashSet<String>();

	@ElementCollection
	@CollectionTable(name = "ADDRESS", joinColumns = @JoinColumn(name = "MEMBER_ID"))
	private List<Address> addressHistory = new ArrayList<Address>();
	//..
}

@Embeddable
public class Address {

	@Column
	private String city;
	private String street;
	private String zipcode;
	//..
}
```

![image](https://user-images.githubusercontent.com/102791105/206370472-5e286d09-1c46-45fb-b73c-6abdde5f3baf.png)


`favoriteFoods`ëŠ” ê¸°ë³¸ê°’ íƒ€ì…ì¸ Stringì„ ì»¬ë ‰ì…˜ìœ¼ë¡œ ê°€ì§„ë‹¤. DB í…Œì´ë¸”ì€ ì»¬ëŸ¼ ì•ˆì— ì»¬ë ‰ì…˜ì„ í¬í•¨í•  ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ ë³„ë„ì˜ í…Œì´ë¸”ì„ ì¶”ê°€í•˜ê³  `@CollectionTable`ì„ ì‚¬ìš©í•´ì„œ ì¶”ê°€í•œ í…Œì´ë¸”ì„ ë§¤í•‘í•´ì•¼ í•œë‹¤. ê·¸ë¦¬ê³  `favoriteFoods`ì²˜ëŸ¼ ê°’ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ì´ í•˜ë‚˜ë©´ `@Column`ì„ ì‚¬ìš©í•´ì„œ ì»¬ëŸ¼ëª…ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. `addressHistory`ëŠ” ì„ë² ë””ë“œ íƒ€ì…ì¸ `Address`ë¥¼ ì»¬ë ‰ì…˜ìœ¼ë¡œ ê°€ì§„ë‹¤. ì´ê²ƒë„ ë³„ë„ì˜ í…Œì´ë¸”ì„ ì‚¬ìš©í•´ì•¼ í•˜ê³ , `@AttributeOverride`ë¥¼ ì‚¬ìš©í•´ì„œ ì¬ì •ì˜í•  ìˆ˜ ìˆë‹¤.

`remove()`, `add()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¬ë ‰ì…˜ ê°’ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤(ë¶ˆë³€ ê°ì²´)

## ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì˜ ì œì•½ì‚¬í•­

íŠ¹ì • ì—”í‹°í‹° í•˜ë‚˜ì— ì†Œì†ëœ ê°’ íƒ€ì…ì€ ê°’ì´ ë³€ê²½ë˜ì–´ë„ ìì‹ ì´ ì†Œì†ëœ ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ê³  ê°’ì„ ë³€ê²½í•˜ë©´ ë˜ì§€ë§Œ, ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ë³´ê´€ëœ ê°’ íƒ€ì…ë“¤ì€ ë³„ë„ì˜ í…Œì´ë¸”ì— ë³´ê´€ëœë‹¤. ê°’ì´ ë³€ê²½ë˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ìˆëŠ” ì›ë³¸ ë°ì´í„°ë¥¼ ì°¾ê¸° ì–´ë µë‹¤ëŠ” ë¬¸ì œê°€ ìˆë‹¤. ì´ëŸ° ë¬¸ì œë¡œ ì¸í•´ JPA êµ¬í˜„ì²´ë“¤ì€ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ë³€ê²½ ì‚¬í•­ì´ ë°œìƒí•˜ë©´ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì´ ë§¤í•‘ëœ í…Œì´ë¸”ì˜ ì—°ê´€ëœ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³ , í˜„ì¬ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ê°ì²´ì— ìˆëŠ” ëª¨ë“  ê°’ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë‹¤ì‹œ ì €ì¥í•œë‹¤. ë”°ë¼ì„œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì´ ë§¤í•‘ëœ í…Œì´ë¸”ì— ë°ì´í„°ê°€ ë§ë‹¤ë©´ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹ ì— **ì¼ëŒ€ë‹¤ ê´€ê³„**ë¥¼ ê³ ë ¤í•´ì•¼ í•œë‹¤.

### ëŠë‚€ ì 

ê°’ íƒ€ì…ì˜ íŠ¹ì§•ì„ ë°°ìš¸ ìˆ˜ ìˆì—ˆë‹¤.

![image](https://user-images.githubusercontent.com/102791105/206350893-9014b2da-5dcd-42b3-a975-34fdc4625a9a.png)

> â€œì¤‘ìš”í•œ ê²ƒì€ ë°”ë€Œì§€ ì•ŠëŠ” ê°ì²´â€
> 

(ë¸Œë¡ ì¦ˆë¼ ì£„ì†¡í•©ë‹ˆë‹¤ğŸ¥‰)
